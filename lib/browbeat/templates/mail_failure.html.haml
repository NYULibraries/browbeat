%p The following applications had no failures:
%ul
  - application_list.each do |application|
    - next if scenarios_for_application?(application)
    %li= application.name
%p The following applications had failures:
- application_list.each do |application|
  - next unless scenarios_for_application?(application)
  %div
    %b= "#{application.name} (#{(scenarios_for_application(application).with_tags(:production).worst_failure_type || 'staging outage').tr('_', ' ')})"
    %ul
      - environments.each do |environment|
        - next unless scenarios_for_application_environment?(application, environment)
        %li
          = environment
          %ol
            - failure_types.each do |failure_type|
              - next unless scenarios_for_application_environment_failure_type(application, environment, failure_type).any?
              - scenarios_for_application_environment_failure_type(application, environment, failure_type).each do |scenario|
                %li
                  = scenario.name
                  %em= "(#{failure_type.tr('_', ' ')})"
                  %ul
                    %li= scenario.exception_message
                    %li= scenario.backtrace_line
- if jenkins_env?
  %p Access failure screenshots:
    %= screenshots_url
